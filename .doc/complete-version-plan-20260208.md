# 象棋AI完整版开发方案（烂柯神机验证版）

**目标日期：** 2026-02-08 18:00（今日下午）  
**验证标准：** 走完烂柯神机棋局无错误  
**优先级：** P0

---

## 一、当前状态评估

### ✅ 已完成
- [x] 走子规则验证（基本规则）
- [x] 标准记谱法
- [x] 轮流走子限制
- [x] Pikafish引擎接入（基础）

### ⚠️ 待验证/完善
- [ ] 复杂规则边界（将军、应将、长将等）
- [ ] AI胜率计算稳定性
- [ ] 走子建议准确性
- [ ] 棋谱数据

---

## 二、今日开发计划（13:30-18:00）

### Phase 1: 规则完善（13:30-15:00）
**负责人：** Lyra  
**任务：**
1. **将军/应将检测**
   - 将军状态判断
   - 应将规则（必须解除将军）
   - 困毙判定

2. **特殊规则**
   - 长将/长捉规则
   - 重复局面判定
   - 和棋规则（50回合、三次重复）

3. **烂柯神机验证**
   - 下载烂柯神机棋谱
   - 逐手验证走子合法性
   - 修复发现的问题

**交付：**
- 规则验证器通过烂柯神机全谱
- 新增将军/应将/和棋测试用例 20+

### Phase 2: AI优化（15:00-16:30）
**负责人：** Lyra  
**任务：**
1. **胜率计算稳定化**
   - Pikafish评估分数转胜率公式优化
   - 不同阶段的胜率权重调整
   - 显示格式：红方 X%（±分差）

2. **走子建议解释**
   - 评估当前局面（优势/劣势）
   - 推荐走法 + 胜率变化（如：+5%）
   - 简化解释：
     * "控制中心，威胁对方車"
     * "保护弱马，防止被捉"
     * "准备进攻，打开线路"

**技术方案：**
```
AI分析流程：
1. 当前局面评估 → 胜率 + 局势描述
2. 推荐走法1 → 胜率变化 + 简要原因
3. 推荐走法2 → 胜率变化 + 简要原因
4. 对比走法 → 解释为什么不推荐
```

**交付：**
- 稳定胜率显示
- 每步建议带解释

### Phase 3: 棋谱数据（16:30-17:30）
**负责人：** Miku（数据收集）+ Lyra（集成）  
**任务：**

1. **古谱收录（必含）**
   - 烂柯神机（150局）
   - 橘中秘（55局）
   - 梅花谱（36局）
   - 适情雅趣（550局，选50经典）
   - 梦入神机（残局，选30经典）

2. **现代名局（选录）**
   - 胡荣华名局（10局）
   - 许银川名局（10局）
   - 王天一名局（10局）

3. **PGN格式支持**
   - 解析标准PGN格式
   - 支持导入/导出棋谱
   - 棋谱浏览（前进/后退）

**数据来源：**
- 中国象棋云库（公开API）
- 东萍象棋网
- 公开棋谱数据库

**交付：**
- 至少100局经典棋谱
- PGN导入功能
- 棋谱浏览界面

### Phase 4: 整合测试（17:30-18:00）
**负责人：** Miku  
**任务：**
- 烂柯神机全谱走通测试
- AI胜率准确性测试
- 棋谱导入测试
- 移动端响应式检查

**交付：**
- 可演示完整版本
- 烂柯神机验证报告

---

## 三、技术调研需求

### 需要调研的项目：

1. **烂柯神机棋谱获取**
   - 来源：公开棋谱数据库
   - 格式：PGN或自定义格式
   - 预计时间：15分钟

2. **Pikafish引擎深度配置**
   - 最优搜索深度（移动端性能平衡）
   - 评估函数解读（用于生成解释）
   - 预计时间：20分钟

3. **PGN格式规范**
   - 标准PGN解析库
   - 中文记谱转换
   - 预计时间：15分钟

---

## 四、风险与应对

| 风险 | 可能性 | 应对 |
|:---|:---:|:---|
| 烂柯神机谱有规则边界情况 | 中 | 逐手验证，发现问题立即修复 |
| AI解释生成不准确 | 高 | 先用模板解释，后期优化 |
| 棋谱数据获取困难 | 低 | 用公开资源，人工整理 |
| 时间不足全部完成 | 中 | 优先级：规则 > AI > 棋谱 |

---

## 五、今日目标检查清单

18:00 验收标准：
- [ ] 能走完烂柯神机棋局无报错
- [ ] AI显示胜率稳定
- [ ] AI给出走子建议+解释
- [ ] 包含至少100局经典棋谱
- [ ] 支持PGN导入

---

**立即开始 Phase 1！** 🚀
